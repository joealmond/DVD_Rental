# DVD Rental

In this task, you will practice writing SQL queries. Take a look at the following keywords, because you will need them
for the solution.

### Setup
Create a database in postgresql and run the sql scripts provided in the project. Make sure to start with the files marked with FIRST and SECOND.

( Alternatively, you can load the sample database from here:
https://www.postgresqltutorial.com/postgresql-getting-started/load-postgresql-sample-database/ )

Save your solution SQL scripts in a file and push them to the repository!

#### See the connections between the tables on this diagram:
https://www.postgresqltutorial.com/wp-content/uploads/2018/03/dvd-rental-sample-database-diagram.png

Alternatively, you can check the image of the diagram included in the project.

## Tasks

### Practice round:

-- count the actors with “Temple” as their last name

-- list all addresses in “England” district with smaller city id’s than 500

-- what is the customer id and the payment amount of the last payment

-- which movie is the cheapest to rent where the DVD includes the deleted scenes

-- list all movies with Dragon in the title

-- how many movie categories start with C

-- how many dvds were rented on the 30th day of any month

-- how much would it cost to rent all PG rated dvds

-- which dvd was rented the earliest in June

-- which is the longest, most expensive (replacement cost) dvd that is PG-13 rated

-- list the rental id for all DVDs which were returned later than one week

### With GROUP BY:

–- which is the most common last name among the actors?

-- calculate how much would it cost to rent all dvds for each rating

-- what is the customer id for the person renting the highest amount of dvds

### Write queries for each of the following questions:

-- Who is the actor with the initials B. D. ?

-- Get a list of all the rentals that happened on your birthday

-- List all actors whose last name starts with B

-- Find all addresses in the system from California district

-- List all the movies which has Japanese language

-- List all Sci-Fi films which feature robot(s)

-- What's the name of the manager of the store on 'MySQL Boulevard'?

-- Which movies were rented when Mike was working?

-- Find the top 10 most expensive rentals and list their prices and customer id

## Background Materials

JOIN: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-joins/

LIKE: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-like/

ORDER BY: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-order-by/

DISTINCT: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-select-distinct/

GROUP BY: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-group-by/

## Optional tasks:

(Requires other keywords like GROUP BY, HAVING, DISTINCT)

-- How many rentals happened in June on each day? Give me a list of the ones bigger than 300.

-- How many films are for each film rating? order them by the largest number

-- How many cities are present in the database from each country?
Count them and show me a list with the country name, count, and names of the cities.
Filter them, so I only see the counts bigger than 20.

-- list the profit of each film category

-- rental_rate , film table
$ -> 0.99
$$ -> 2.99
$$$ -> 4.99

-- Select the ids, full names, and the sum of payments of customers, who paid more than 180 dollars already!

-- Categorize customers - HIGH, MEDIUM, LOW - based on how much income they contributed to our business!
(HIGH, above 180, MEDIUM - above 80, LOW - otherwise. Hint: CASE - WHEN)

-- How many HIGH, MEDIUM, and LOW category customers do we have?

-- How much income was generated by each group?

-- What is each category's minimum, maximum, and average of the generated outcome?

## Keywords for Optional tasks

COUNT: https://www.postgresqltutorial.com/postgresql-aggregate-functions/postgresql-count-function/

MAX: https://www.postgresqltutorial.com/postgresql-aggregate-functions/postgresql-max-function/

HAVING: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-having/

SUB QUERY: https://www.postgresqltutorial.com/postgresql-tutorial/postgresql-subquery/
